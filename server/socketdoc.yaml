asyncapi: 2.6.0
info:
  title: Chefswap Messaging
  version: 1.0.0
  description: Messaging websocket api for chefswap
servers:
  development:
    url: ws://localhost:3001
    protocol: ws
    description: Development server
channels:
  /:
    subscribe:
      operationId: receiveMessage
      summary: Receive a message from the server
      message:
        oneOf:
          - $ref: "#/components/messages/ReceiveUserMessage"
          - $ref: "#/components/messages/ReceiveSystemMessage"
    publish:
      operationId: sendMessage
      summary: Send a message to the server
      message:
        $ref: "#/components/messages/SendUserMessage"
components:
  messages:
    SendUserMessage:
      name: sendUserMessage
      contentType: application/json
      payload:
        type: object
        properties:
          receiver_uid:
            type: string
            format: uuid
          message:
            $ref: "#/components/schemas/message"
    ReceiveUserMessage:
      name: ReceiveMessage
      contentType: application/json
      payload:
        type: object
        properties:
          message_uid:
            type: string
            format: uuid
          sender_uid:
            type: string
            format: uuid
          receiver_uid:
            type: string
            format: uuid
          message:
            $ref: "#/components/schemas/message"
          timestamp:
            type: string
            format: date-time
    ReceiveSystemMessage:
      name: ReceiveSystemMessage
      contentType: application/json
      payload:
        type: object
        properties:
          message_uid:
            type: string
            format: uuid
          account1_uid:
            type: string
            format: uuid
          account2_uid:
            type: string
            format: uuid
          message:
            $ref: "#/components/schemas/message"
          timestamp:
            type: string
            format: date-time
  schemas:
    message:
      type: string
      maxLength: 300
